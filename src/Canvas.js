import React, {useRef, useState} from "react";
import CanvasDraw from "react-canvas-draw";
import {Button, Dialog, DialogActions, DialogContent, DialogTitle} from "@material-ui/core";

const DRAW = '{"lines":[{"points":[{"x":84.80238045215829,"y":268.02685565066577},{"x":84.80238045215829,"y":268.02685565066577},{"x":84.80238045215829,"y":268.02685565066577},{"x":90.35949289686782,"y":257.5917269422656},{"x":115.85687417863133,"y":203.84196738537665},{"x":136.51251634856723,"y":163.6718097422723},{"x":153.0824964228317,"y":134.43949957680923},{"x":162.8106747773504,"y":118.28067377598732},{"x":165.50646345263644,"y":114.09128253038502},{"x":166.6785878453949,"y":112.19998766526759},{"x":167.00256297818228,"y":111.74863452621418},{"x":167.38902118070618,"y":111.27755363294985},{"x":170.41769929499912,"y":109.65817212436471},{"x":174.31761619253504,"y":108.74260981094291},{"x":185.57076798104694,"y":112.34313584379483},{"x":194.85477361322123,"y":120.23051904342606},{"x":204.80248857742686,"y":136.7242590453498},{"x":208.50208879595363,"y":145.8748575379677},{"x":210.60937106752814,"y":156.24054026295303},{"x":210.8651517817431,"y":179.00075769233604},{"x":209.31445875371728,"y":193.07220899810966},{"x":206.65795773768022,"y":212.1150861955138},{"x":205.67245659509166,"y":219.11711781857892},{"x":204.55065772666504,"y":224.27421025425562},{"x":203.35690382178026,"y":230.23373447627168},{"x":201.13891833428903,"y":238.41780712944805},{"x":196.2864150005061,"y":255.4587922449837},{"x":193.511697956761,"y":264.52533323096134},{"x":190.51981145601965,"y":271.8837369407686},{"x":188.3447630611618,"y":276.25600131142784},{"x":187.36295479090631,"y":277.82587564805294},{"x":186.12597578045919,"y":279.1700216526092},{"x":185.4929879656925,"y":279.65948370458744},{"x":183.4234829955443,"y":280.3252161627505},{"x":171.8808802632047,"y":278.6866191542234},{"x":159.87258102728333,"y":273.0780884006837},{"x":136.6808568566919,"y":256.09091041547146},{"x":122.34221994363313,"y":244.53146244263246},{"x":111.89125426850674,"y":235.0588831442552},{"x":104.22326245519778,"y":228.676680902743},{"x":102.08833697196783,"y":226.83595119203548},{"x":102.08833697196783,"y":226.83595119203548},{"x":102.08833697196783,"y":226.83595119203548},{"x":102.08833697196783,"y":226.83595119203548},{"x":102.08833697196783,"y":226.83595119203548},{"x":109.73264878081036,"y":222.2114007230097},{"x":131.20385265765418,"y":218.20247766791576},{"x":146.01206438682425,"y":217.53795885934974},{"x":158.02222679077454,"y":218.2699664744953},{"x":167.0406006583708,"y":219.01371029233846},{"x":170.025996739038,"y":219.210540750595},{"x":170.1317998554108,"y":219.2263525355998},{"x":171.11238686580973,"y":219.36150862930955},{"x":172.24384879855182,"y":219.5931537380446},{"x":172.24384879855182,"y":219.5931537380446},{"x":172.47421126097674,"y":219.65991108750015},{"x":172.47421126097674,"y":219.65991108750015},{"x":172.47421126097674,"y":219.65991108750015},{"x":172.47421126097674,"y":219.65991108750015},{"x":172.47421126097674,"y":219.65991108750015},{"x":169.9484029582199,"y":223.21635567233758},{"x":163.07905279517175,"y":229.1532936627854},{"x":153.71184245917846,"y":235.95158769309722},{"x":149.01443144268382,"y":240.07913983426337},{"x":145.78478051564298,"y":243.867793677141},{"x":139.6399547988508,"y":255.40797895267764},{"x":135.84200116833466,"y":264.02024478024003},{"x":131.0964926595018,"y":274.13603375503936},{"x":129.17013576378721,"y":278.1708866390637},{"x":128.20110302081116,"y":280.18572575866006},{"x":127.57702609146183,"y":281.3747103580583},{"x":126.9089150784677,"y":282.55563680277936},{"x":126.20184427732134,"y":283.7268735255592},{"x":125.07318540514727,"y":285.65029377060847},{"x":123.20974739082723,"y":288.73164875249614},{"x":119.9117846977591,"y":294.55726081493265},{"x":117.47165488747999,"y":299.3200658807127},{"x":115.44317465409607,"y":303.3055224678806},{"x":114.43115962146648,"y":305.2994156623971},{"x":114.05237557408718,"y":306.1154466762128},{"x":113.69482135913715,"y":306.95651085907224},{"x":113.12968592645112,"y":308.15166730340695},{"x":112.51395357959916,"y":309.3418427520502},{"x":111.91439221623634,"y":310.1922897534618},{"x":111.91439221623634,"y":310.1922897534618},{"x":111.80187335638337,"y":310.17158589051604},{"x":101.05980195394929,"y":280.2923871743183},{"x":97.02032898761249,"y":232.95654334484},{"x":102.23782667661828,"y":150.97577103259434},{"x":106.36801931250473,"y":120.88850869687373},{"x":108.88651837519568,"y":106.81241700168151},{"x":110.22458862373382,"y":97.86793640213094},{"x":111.51922935087757,"y":91.7407741221119},{"x":118.23742611637736,"y":71.39486892290915},{"x":123.97176168541905,"y":55.303685066426},{"x":128.6649569588212,"y":43.18961133512363},{"x":131.90235651513177,"y":34.27871082486456},{"x":132.3988364998631,"y":33.08283783356086},{"x":132.95313301795076,"y":31.88710859987633},{"x":133.1734089790833,"y":31.490511764207348},{"x":133.8242526769772,"y":30.618141730923465},{"x":139.47169398939434,"y":26.29461339402273},{"x":147.04742287080077,"y":22.903167774912692},{"x":167.13883682545114,"y":19.82011212476765},{"x":181.00029029741324,"y":19.9165311216965},{"x":194.1569473654945,"y":22.065548063059726},{"x":211.2688671395112,"y":30.629451840776667},{"x":219.41875889122463,"y":36.7750557915294},{"x":231.40157891092767,"y":54.976984529030915},{"x":238.120570375772,"y":74.64438351340351},{"x":241.78844617837657,"y":94.20555089484623},{"x":242.58240924872925,"y":117.00726811921265},{"x":241.78972855185776,"y":129.02601449748744},{"x":238.61078452423737,"y":143.2874509961323},{"x":234.2588323266397,"y":152.21368076866398},{"x":224.88801655051174,"y":162.95681500250862},{"x":205.69944491955067,"y":176.93453693997324},{"x":189.4510316943624,"y":186.1028874418549},{"x":169.22382221616033,"y":193.75431809245848},{"x":158.6790643510375,"y":196.24328893709827},{"x":142.97590430267135,"y":197.23992360038116},{"x":133.93216070862738,"y":196.2741824137418},{"x":125.73326641909968,"y":194.51604036899803},{"x":116.596604019707,"y":192.08525123938315},{"x":114.49245575800884,"y":191.4530364391662},{"x":114.49245575800884,"y":191.4530364391662},{"x":114.49245575800884,"y":191.4530364391662},{"x":114.49245575800884,"y":191.4530364391662},{"x":114.49245575800884,"y":191.4530364391662},{"x":118.02163574399077,"y":197.59523374493827},{"x":131.59662706733027,"y":211.43359332307452},{"x":162.88167008876408,"y":238.19897060447403},{"x":178.75769870377985,"y":251.34625145762632},{"x":188.6912218392551,"y":259.4272429621677},{"x":189.77347418224286,"y":260.3272416085047},{"x":190.8479949644506,"y":261.23850505190666},{"x":191.9154039496348,"y":262.1597120842606},{"x":194.4207000737449,"y":264.6097906596224},{"x":196.43855146977086,"y":266.59157570859816},{"x":198.29192228497703,"y":268.8029603709038},{"x":199.72565253554993,"y":270.3089025987768},{"x":201.54222797639136,"y":272.5988491957697},{"x":201.54222797639136,"y":272.5988491957697},{"x":202.4292026959277,"y":273.68962792469324},{"x":202.89762362453962,"y":274.32755202540216},{"x":203.74393140684853,"y":275.4423084078068},{"x":205.63856116335458,"y":277.3926577516031},{"x":208.22862029396873,"y":279.8108060193556},{"x":215.29291730528794,"y":284.9450339789605},{"x":220.603821778885,"y":288.0067138901255},{"x":224.20615454069483,"y":289.7566327421554},{"x":227.94422263854008,"y":291.3341895737364},{"x":229.13957515527758,"y":291.895965106689},{"x":229.13957515527758,"y":291.895965106689},{"x":229.97733688140954,"y":292.25648887699566},{"x":229.97733688140954,"y":292.25648887699566},{"x":232.3439441308604,"y":293.48198647031603},{"x":236.62500672215143,"y":295.9701148862854},{"x":247.11649911533334,"y":303.19438391746985},{"x":255.24338146341958,"y":309.0136994960383},{"x":263.57312897578583,"y":315.5747658156236},{"x":266.43894635226104,"y":317.7483620370942},{"x":267.5440614567217,"y":318.61181847368755},{"x":267.5440614567217,"y":318.61181847368755}],"brushColor":"#444","brushRadius":10}],"width":400,"height":400}'

const Canvas = () => {

  const [modal, setModal] = useState(false);

  const canvasDraw = useRef(null);

  /*const handleCanvasChange = () => {
    const draw = canvasDraw.current.getSaveData();

    let encoded = btoa(JSON.stringify(draw))

    console.log(draw)
  };*/

  const handleCanvasChange = () => {
    const base64 = canvasDraw.current.canvasContainer.childNodes[1].toDataURL();
    console.log(base64)
  };

  return (
    <>
      <Button variant="outlined" onClick={() => setModal(true)}>Modal</Button>
      <Dialog open={modal} onClose={() => setModal(false)}>
        <DialogTitle>Dialog Title</DialogTitle>
        <DialogContent>
          {/*<CanvasDraw ref={canvasDraw} saveData={DRAW} onChange={handleCanvasChange}/>*/}
          <CanvasDraw canvasHeight={150} canvasWidth={500} hideGrid={true} hideInterface={true}
                      brushRadius={2}
                      ref={canvasDraw} onChange={handleCanvasChange} style={{border: "1px solid black"}}/>
        </DialogContent>
        <DialogActions>
          <Button onClick={() => setModal(false)} color="primary">
            Cancel
          </Button>
        </DialogActions>
      </Dialog>
    </>
  )
}

export default Canvas;
